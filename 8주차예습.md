# 8주차 예습

## C4W1L1

### Computer Vision

- 입력이 매우 클수있다는 문제가 있습니다.
- 64pixel 의 컬러 이미지라면 64 x 3 x 64 가되서 x의 크기가 12288 이됩니다.
- 1000pixel 만 되어도 3000000 개의 feature가 존재하게됩니다.

- 이러한 이미지크기를 고민하지 않기위해서는 Convolution operation을 알아야합니다.

## C4W1L2

### Convolutional Neural Networks

- 합성곱 작업은 합성곱 신경망의 핵심 요소입니다.

#### Vertical Edge detection

- 6x6x1 grey scale image 가 있을때

```
3 | 0 | 1 | 2 | 7 | 4
1 | 5 | 8 | 9 | 3 | 1
2 | 7 | 2 | 5 | 1 | 3
0 | 1 | 3 | 1 | 7 | 8
4 | 2 | 1 | 6 | 2 | 8
2 | 4 | 5 | 2 | 3 | 9
```

- 3x3 필터를 만듭니다. (커널이라고도 부릅니다.)

```
1 | 0 | -1
1 | 0 | -1
1 | 0 | -1
```

- 6x6 image와 3x3 을 convolution 시켜줍니다.
- convolution 하면 4x4 이미지가 나옵니다.
- `conv2d` 라는 이름으로 convolution을 구현할수 있습니다.

##### 어떻게 수직을 감지하는가 ?

```
10 | 10 | 10 | 0 | 0 | 0
10 | 10 | 10 | 0 | 0 | 0
10 | 10 | 10 | 0 | 0 | 0
10 | 10 | 10 | 0 | 0 | 0
10 | 10 | 10 | 0 | 0 | 0
10 | 10 | 10 | 0 | 0 | 0
```

- 10이 더 밝은 값이고 0 이 어두운 값으로 10과 0 사이에는 세로 경계선이 생기게 됩니다.

- 여기서 아까 만들었던 3x3 필터를 곱하게 되면

```
0 | 30 | 30 | 0
0 | 30 | 30 | 0
0 | 30 | 30 | 0
0 | 30 | 30 | 0
```

- 다음과 같은 4x4 행렬이 나오는데
- 30이 밝고 0 이 어두운 값입니다.
- 경계선이 밝은 부분이라 생각하면 경계선을 검출 할수있습니다.
- 실제 선보다 좀 굵다고 생각할수있지만 이미지 크기가 커지면 유의미한 결과를 얻을수 있습니다.

## C2W1L3

### More edge detection

```
10 | 10 | 10 | 0 | 0 | 0
10 | 10 | 10 | 0 | 0 | 0
10 | 10 | 10 | 0 | 0 | 0
0  | 0  | 0  | 10| 10| 10
0  | 0  | 0  | 10| 10| 10
0  | 0  | 0  | 10| 10| 10

```

```
1 | 1 | 1
0 | 0 | 0
-1| -1| -1
```

- 위에 행렬을 아래행렬(Horizontal filter)로 필터링 한다면

```
0 | 0 | 0 | 0
30| 10|-10|-30
30| 10|-10|-30
0 | 0 | 0 | 0
```

- 이런 결과가 나오게 됩니다.

#### filter 종류

- sobel

```
1 | 0 | -1
2 | 0 | -2
1 | 0 | -1
```

- scharr

```
3  | 0 | -3
10 | 0 | -10
3  | 0 | -3
```

### filter 선택 할필요x

- filter의 9개의 숫자를 직접 선택할필요 없이 변수로 둡니다.
- 그리고 학습후에 적절한 숫자를 선택하게 만들면 됩니다.

## C2W1L4

### 기존방식

- 가장자리나 모서리에 있는 값은 필터에 거의 걸치지 않아서 상대적으로 적게 사용됩니다.
  - 이미지 가장자리는 거의 버리게 됩니다.
- 지속해서 하게되면 크기가 계속 작아지게 됩니다.

### Padding

- 가장자리에 1픽셀 만큼 더해주는 것입니다.
- 6x6 이미지에서 1픽셀 만큼 더해주면 8x8 이미지가 됩니다.
- 여기서 3x3 필터를 거치게 되면 결과가 6x6 그대로 나오게 됩니다.
- 일반적으로 0을 패딩으로 더해줍니다.

- 가장자리 정보를 덜 가져오는 일을 방지해 줍니다.

#### 패딩을 얼마만큼 할것인가

- filter 값은 거의 홀수 값으로 정해집니다.
  - 3x3 정도가 일반적이고
  - 1x1, 5x5, 7x7 도 쓰인다.

##### valid

- no padding
- `6x6 * 3x3 = 4x4` 라는 예시와 같은것

##### same

- output size가 필터링 하기 전과 같은 size가 나오도록 하는것입니다.

## C4W1L5

### Strided Convolution

- Stride = 2 : filter 박스를 원래는 한칸 옮기게 되는데 2칸 옮기라는 의미입니다.
  - 아래로 내려갈때도 한칸이 아니라 두칸 이동합니다.
- `( (n+2p-f)/s ) + 1` 의 결과행렬크기를 가집니다.

  - 분수가 정수꼴이 아니라면 내림해줍니다.

- 원래는 뒤집는 과정이 convolution 에 있지만 딥러닝에서는 하지않는다
  - 하지만 관습적으로 convolution 이라고 부릅니다.

## C4W1L6

### RGB 이미지 에서의 convolution

- height x width x channels 로 이미지를 표현합니다.
- 하지면 필터를 곱하고 나면 hegiht x width 만 남습니다.

- `6x6x3 * 3x3x3 = 4x4` 이게 됩니다.

### multiple filters

- 두개의 3x3x3 을 6x6x3 에 적용하여서 두개의 4x4 를 얻을수 있습니다.
- 4x4 두개를 겹치게 되면 4x4x2 가 될수있습니다.
